<?php

function render($ptApp, $data) {
    $ret = '<h1>Ticket Description</h1>';
    $ret .= '<h2>Regular Tickets and Fiscal Tickets</h2>';
    $ret .= "<p>Each ticket generates two records. The first, called regular, is highly structured and can evolve with feature additions or fixes. Regular records are used by management interfaces to perform calculations. The second, called fiscal, is a snapshot at the time of recording. These are weakly structured and cannot be modified under any circumstances. These records are signed and their integrity can be controlled. The records present on this interface are the fiscal records.</p>";
    $ret .= '<h2>Sequences</h2>';
    $ret .= "<p>Each cash register generates 2 ticket sequences, and possibly two error sequences. One sequence groups sales tickets, the other Z tickets. In case of a recording error, an error ticket is entered in the corresponding error sequence.</p>";
    $ret .= "<p>The emphasized fields correspond to identification, revenue and VAT.</p>";
    $ret .= "<p>Signature control attests to the integrity of the ticket content as well as its chaining with the previous ticket.</p>";
    $ret .= "<p>Each sequence has a special record that always bears the number 0 and contains EOS (End Of Sequence). This record allows checking the completeness of the sequence. Its signature is chained to the last ticket in the sequence.</p>";
    $ret .= '<h2>Sales Ticket Description</h2>';
    $ret .= "<h3>General Fields</h3>";
    $ret .= '<dl>';
    $ret .= '<dt><em>sequence</em></dt><dd>Indicates the sequence number of the cash session during which the ticket was recorded.</dd>';
    $ret .= "<dt><em>number</em></dt><dd>The ticket number. This is linked to the cash register and is never reset to zero.</dd>";
    $ret .= "<dt><em>date</em></dt><dd>The date and time of the sale.</dd>";
    $ret .= "<dt>custCount</dt><dd>The number of guests specified (optional).</dd>";
    $ret .= "<dt><em>price</em></dt><dd>The pre-tax selling price of the ticket before discount.</dd>";
    $ret .= "<dt><em>taxedPrice</em></dt><dd>The tax-inclusive selling price of the ticket before discount.</dd>";
    $ret .= "<dt><em>discountRate</em></dt><dd>The discount rate applied to the ticket.</dd>";
    $ret .= "<dt><em>finalPrice</em></dt><dd>The pre-tax selling price of the ticket.</dd>";
    $ret .= "<dt><em>finalTaxedPrice</em></dt><dd>The tax-inclusive selling price of the ticket.</dd>";
    $ret .= "<dt>custBalance</dt><dd>The variation in customer account balance.</dd>";
    $ret .= "<dt><em>cashRegister</em></dt><dd>The cash register on which the sale was recorded.</dd>";
    $ret .= "<dt>user</dt><dd>The name of the account with which the sale was recorded.</dd>";
    $ret .= "<dt>version</dt><dd>The API version at the time of recording.</dd>";
    $ret .= '</dl>';
    $ret .= '<h3>Ticket Lines</h3>';
    $ret .= "<p>Line-by-line information is grouped in the <em>lines</em> field.</p>";
    $ret .= '<dl>';
    $ret .= "<dt>dispOrder</dt><dd>The line number.</dd>";
    $ret .= "<dt>productLabel</dt><dd>The product designation</dd>";
    $ret .= "<dt><em>unitPrice</em></dt><dd>The pre-tax unit price. It is not filled when the tax-inclusive amount is used for sum calculations to avoid rounding errors.</dd>";
    $ret .= "<dt><em>taxedUnitPrice</em></dt><dd>The tax-inclusive unit price. It is not filled when the pre-tax amount is used for sum calculations.</dd>";
    $ret .= "<dt><em>quantity</em></dt><dd>The quantity.</dd>";
    $ret .= "<dt><em>price</em><dt><dd>The pre-tax amount of the line before discount. It is not filled when the tax-inclusive amount is used for sum calculations.</dd>";
    $ret .= "<dt><em>taxedPrice</em><dt><dd>The tax-inclusive amount of the line before discount. It is not filled when the pre-tax amount is used for sum calculations.</dd>";
    $ret .= "<dt><em>taxRate</em><dt><dd>The VAT rate applied at the time of sale.</dd>";
    $ret .= "<dt><em>discountRate</em></dt><dd>The discount rate applied to the line.</dd>";
    $ret .= "<dt><em>finalPrice</em><dt><dd>The pre-tax amount of the line. It is not filled when the tax-inclusive amount is used for sum calculation.</dd>";
    $ret .= "<dt><em>finalTaxedPrice</em><dt><dd>The tax-inclusive amount of the line. It is not filled when the pre-tax amount is used for sum calculation.</dd>";
    $ret .= '</dl>';
    $ret .= '<h3>VAT</h3>';
    $ret .= "<p>Information related to the total VAT amount of the ticket is grouped in the <em>taxes</em> field. Each VAT rate has its own total.</p>";
    $ret .= '<dl>';
    $ret .= "<dt><em>base</em></dt><dd>The pre-tax amount of the ticket corresponding to this VAT rate.</dd>";
    $ret .= "<dt><em>taxRate</em></dt><dd>The VAT rate.</dd>";
    $ret .= "<dt><em>amount</em></dt><dd>The VAT amount associated with this rate.</dd>";
    $ret .= '</dl>';
    $ret .= '<h3>Payments</h3>';
    $ret .= "<p>Information related to ticket payments is grouped in the <em>payments</em> field. Each payment has its own information. The same applies to any returns, with negative quantities.</p>";
    $ret .= "<p>A ticket can only be recorded when the payment amount is equal to or greater than the ticket amount. A ticket cannot be recorded with partial payment.</p>";
    $ret .= '<dl>';
    $ret .= "<dt>dispOrder</dt><dd>The payment number</dd>";
    $ret .= "<dt><em>amount</em></dt><dd>The amount converted to main currency collected or returned, when negative.</dd>";
    $ret .= "<dt>currencyAmount</dt><dd>The amount in currency collected or returned.</dd>";
    $ret .= "<dt><em>paymentMode</em></dt><dd>The reference and designation of the payment method used.</dd>";
    $ret .= "<dt>currency</dt><dd>The reference and designation of the currency used.</dd>";
    $ret .= "<dt>type</dt><dd>Equivalent to the payment method reference (compatibility field).</dd>";
    $ret .= '</dl>';
    $ret .= '<h3>Customer Information</h3>';
    $ret .= "<p>When a customer account is assigned to the ticket, customer information is listed in the <em>customer</em> field. The fields take the customer record information at the time of sale.</p>";
    $ret .= '<h3>Tariff Area</h3>';
    $ret .= "<p>When a tariff area, which allows indicating alternative rates, is used, it is indicated for information purposes in the <em>tariffArea</em> field. Effective prices are indicated in the ticket lines.</p>";
    $ret .= '<h3>Discount Profile</h3>';
    $ret .= "<p>When a discount profile, which allows automatically associating a reduction rate to the ticket, is used, it is indicated for information purposes in the <em>discountProfile</em> field. The discount rate indicated in the general information corresponds to the applied rate.</p>";
    $ret .= '<dl>';
    $ret .= "<dt>label</dt><dd>The name of the discount profile.</dd>";
    $ret .= "<dt>rate</dt><dd>The rate normally associated with this profile. The effective discount rate is indicated in the ticket's <em>discountRate</em> field.</dd>";
    $ret .= '</dl>';

    $ret .= '<h2>Z Tickets</h2>';
    $ret .= "<p>Z tickets are generated at each cash register closure. They contain the session summary data as well as cumulative data. These cumulative amounts are reset to zero when the period is closed instead of performing a simple closure at the end of the cash session. The choice of closure type is manual and left to the user.</p>";
    $ret .= '<h3>General Information</h3>';
    $ret .= '<dl>';
    $ret .= "<dt><em>sequence</em></dt><dd>The session sequence number. It starts at 1 and is incremented with each session.</dd>";
    $ret .= "<dt><em>continuous</em></dt><dd>Cash session continuity control. When it is false, this cash session does not directly follow the previous one. For example, following equipment change or reinstallation.</dd>";
    $ret .= "<dt><em>openDate</em></dt><dd>The session opening date and time.</dd>";
    $ret .= "<dt><em>closeDate</em></dt><dd>The session closing date and time.</dd>";
    $ret .= "<dt>openCash</dt><dd>The declared amount of cash drawer at opening.</dd>";
    $ret .= "<dt>closeCash</dt><dd>The declared amount of cash drawer at closing.</dd>";
    $ret .= "<dt>expectedCash</dt><dd>The expected amount of cash drawer at closing (opening cash plus collections).</dd>";
    $ret .= "<dt>ticketCount</dt><dd>The number of tickets recorded during the session.</dd>";
    $ret .= "<dt>custCount</dt><dd>The total number of guests in the session (optional).</dd>";
    $ret .= "<dt><em>cs</em></dt><dd>The pre-tax revenue amount achieved during this session.</dd>";
    $ret .= "<dt><em>csPeriod</em></dt><dd>The pre-tax revenue amount achieved over the period.</dd>";
    $ret .= "<dt><em>csFYear</em><dt><dd>The pre-tax revenue amount achieved over the fiscal year.</dd>";
    $ret .= "<dt><em>csPerpetual</em><dt><dd>The pre-tax revenue amount achieved on this cash register. This amount is never reset to zero.</dd>";
    $ret .= "<dt>cashRegister</dt><dd>The cash register identification.</dd>";
    $ret .= "<dt>version</dt><dd>The API version at the time of recording.</dd>";
    $ret .= '</dl>';
    $ret .= '<h3>Payments</h3>';
    $ret .= "<p>Information related to session payments is grouped in the <em>payments</em> field. Each payment method has its own information.</p>";
    $ret .= '<dl>';
    $ret .= "<dt><em>amount</em></dt><dd>The amount converted to main currency.</dd>";
    $ret .= "<dt>currencyAmount</dt><dd>The amount in currency.</dd>";
    $ret .= "<dt><em>paymentMode</em></dt><dd>The reference and designation of the payment method used.</dd>";
    $ret .= "<dt>currency</dt><dd>The reference and designation of the currency used.</dd>";
    $ret .= '</dl>';
    $ret .= '<h3>VAT</h3>';
    $ret .= "<p>Information related to VAT amounts collected during the session is grouped in the <em>taxes</em> field. Each VAT rate has its own total.</p>";
    $ret .= '<dl>';
    $ret .= "<dt><em>base</em></dt><dd>The pre-tax amount corresponding to this VAT rate.</dd>";
    $ret .= "<dt><em>taxRate</em></dt><dd>The VAT rate.</dd>";
    $ret .= "<dt><em>amount</em></dt><dd>The VAT amount associated with this rate.</dd>";
    $ret .= "<dt><em>basePeriod, baseFYear, amountPeriod, amountFYear</em></dt><dd>Cumulative amounts over monthly period (Period) and annual (FYear).</dd>";
    $ret .= '</dl>';
    $ret .= '<h3>Sales by Categories</h3>';
    $ret .= "<p>Pre-tax amounts achieved by category are grouped in the <em>catSales</em> field. These amounts are indicative and may show a few cents difference from the session total due to intermediate calculations.</p>";
    $ret .= '<dl>';
    $ret .= "<dt>reference</dt><dd>The category identifier.</dd>";
    $ret .= "<dt>label</dt><dd>The category title.</dd>";
    $ret .= "<dt>amount</dt><dd>The approximate pre-tax amount associated with the category.</dd>";
    $ret .= '</dl>';
    $ret .= '<h3>Sales by Categories and VAT</h3>';
    $ret .= "<p>VAT amounts grouped by categories are grouped in the <em>catTaxes</em> field. These amounts are indicative and may show a few cents difference from the session total due to intermediate calculations.</p>";
    $ret .= "<dt>reference</dt><dd>The category identifier.</dd>";
    $ret .= "<dt>label</dt><dd>The category title.</dd>";
    $ret .= "<dt>base</dt><dd>The approximate pre-tax amount associated with the category and VAT rate.</dd>";
    $ret .= "<dd>amount</dt><dd>The approximate VAT amount associated.</dd>";
    $ret .= "<dt>tax</dt><dd>The tax name.</dd>";
    $ret .= "<dt>taxRate</td><dd>The VAT rate.</dd>";

    $ret .= '<h3>Customer Balances</h3>';
    $ret .= "<p>Customer account variations are grouped in the <em>custBalances</em> field. Each customer has its own entry.</p>";
    $ret .= "<dt>balance</dt><dd>The amount of customer account balance variation over the session.</dd>";
    $ret .= "<dt>customer</dt><dd>Customer account identification information.</dd>";
    return $ret;
}
